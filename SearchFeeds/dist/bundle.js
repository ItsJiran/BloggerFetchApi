function preg_match_all(r,e){for(regexs=[];null!==(array1=r.exec(e));)regexs.push(array1[0]);return regexs}
class Builder{static template="";static build(t){let e=this.buildTemplate(t);return this.buildElement(e)}static buildTemplate(t={}){let e=this.template;return e=this.addEmbeds(e,t),e}static buildElement(t=this.buildTemplate()){return t=this.cleanSlots(t),(new DOMParser).parseFromString(t,"text/html").body.firstElementChild}static addEmbeds(t=this.template,e={}){if(null==e.embeds)return t;for(let s of e.embeds)t=t.replaceAll("{{"+s+"}}",e[s]);return t}static getSlots(t=this.template){return preg_match_all(/\[\[(?![^\]]*\/\])[^\]]*\]\]/g,t)}static addSlot(t=this.template,e="",s=""){if(""==s)return;let a=this.getSlots(t);for(let i of a)if(i==s){t=t.replaceAll(i,e);break}return t}static cleanSlots(t=this.template){let e=this.getSlots(t);for(let s of e)t=t.replaceAll(s,"");return t}}class PostBuilder extends Builder{static template='\n        <div class=\'post-outer\'>\n            <article class=\'post hentry\' itemprop=\'blogPost\' itemscope=\'itemscope\' itemtype=\'https://schema.opg/BlogPosting\'>\n                <div class="post-body entry-content" itemprop="articleBody">\n                    <div class="box-deg">\n                        <div class="post-thumbnail">\n                            <div class="blanterimgthumb">\n                                <a href="{{link}}"><img alt="{{title}}" height="74" itemprop="image" src="{{img_src}}" title="{{title}}" width="74"></a></div>\n                            </div>\n                        </div>\t\t\t\t\t\t\t\n                        <div class="box-body-deg">\n                            [[post-label]]\n                            <h2 class="post-title entry-title" itemprop="name headline">\n                                <a href="{{link}}" itemprop="url" title="{{title}}">{{title}}</a>\n                            </h2>\n                            <div class="snippet-material" itemprop="description">{{description}}</div>\n                        </div>\n                    </div>\n                </div>\n            </article>\n        </div>\n    '}class PostLabelBuilder extends Builder{static template='\n        <div class="label-info">\n            <a href="{{label_link}}" rel="tag"><i class="fa-solid fa-hashtag"></i>{{label}}</a>\n        </div>\n    '}class PaginationLink extends Builder{static template="\n        <a class='BSearch-pagination' href='{{link}}'>\t\n            {{title}}\n        </a>\n    "}class EmptyPosts extends Builder{static template="\n        <div class='post-outer'>\n            <article class='post hentry' itemprop='blogPost' itemscope='itemscope' itemtype='https://schema.opg/BlogPosting'>\n                <div class=\"post-body entry-content\" itemprop=\"articleBody\">\n                    <div class=\"box-deg\" style='text-align:center;'>\t\t\t\t                                           \n                            <h2 class=\"post-title entry-title\" itemprop=\"name headline\">Empty Post</h2>\n                            <div class=\"snippet-material\" itemprop=\"description\">Looks like there're post that can be found, you can go back to the homepage, by pressing button below..</div>\n                            <a href='/' class='js-load e-waves'>Back To Home</a>\n                    </div>\n                </div>\n            </article>\n        </div>\n    "}class ReloadPosts extends Builder{static template="\n        <div class='post-outer'>\n            <article class='post hentry' itemprop='blogPost' itemscope='itemscope' itemtype='https://schema.opg/BlogPosting'>\n                <div class=\"post-body entry-content\" itemprop=\"articleBody\">\n                    <div class=\"box-deg\" style='text-align:center;'>\t\t\t\t                                           \n                            <h2 class=\"post-title entry-title\" itemprop=\"name headline\">Oops!! Looks like there's a problem</h2>\n                            <div class=\"snippet-material\" itemprop=\"description\">You can press button below to try again</div>\n                            <a id='reload-posts-btn' href='javascript:Main.run();' class='js-load e-waves'>Reload Posts</a>\n                    </div>\n                </div>\n            </article>\n        </div>\n    "}class PaginationLazyButton extends Builder{static template='\n        <a class="js-load e-waves"><i class="fa fa-angle-down"></i>Lainnya</a>\n    '}class PaginationLazyLoader extends Builder{static template='\n        <span class="js-loading" style="cursor:wait;"><i class="fas fa-circle-notch fa-spin"></i></span>\n    '}class PaginationMax extends Builder{static template='\n         <a class="js-load e-waves">Max Posts</a>\n    '}class PaginationReload extends Builder{static template='\n         <a class="js-load e-waves">Reload Posts</a>\n    '}
class BlogPaginationEntity{constructor(t={}){this.link=t.link?t.link:"",this.title=t.title?t.title:"",this.embeds=["link","title"]}}class BlogPostEntity{constructor(t){this.title=""==t.title.$t?"Undefined Title":t.title.$t,this.content=t.content.$t,this.content_type=t.content.type,this.published=t.published.$t,this.updated=t.updated.$t,this.links=t.link,this.link=this.buildLink(),this.labels=this.buildTerm(t),this.authors=this.buildAuthors(t.author),this.author=this.authors[0],this.author_name=this.authors[0].name,this.elements=this.buildElements(this.content),this.description=this.buildDescription(this.elements),this.img_src=this.buildImgSrc(this.elements),this.embeds=["published","content","description","updated","link","title","img_src"]}buildLink(){for(let t of this.links)if("alternate"==t.rel)return t.href;return"#"}buildTerm(t){let i=[];if(null!=t.category)for(let e of t.category)i.push(new BlogsLabelEntity(e.term));return i}buildDescription(t){let i=t.innerText;return i.trim(),i.length>133&&(i=i.slice(0,130),i+="..."),i}buildImgSrc(t){let i=t.getElementsByClassName("search-posts-thumbnail")[0],e=t.getElementsByTagName("img")[0];return null==i&&null==e?"https://2.bp.blogspot.com/-dEUogHGF5yU/Wu0UW3B8JMI/AAAAAAAAJ-0/b5QVUcmL1nUvP0BGa0PX4rA8UyFhlvVIQCLcBGAs/s340/lina.jpg":null!=i?i.src:null!=e?e.src:void 0}buildAuthors(t){let i=[];for(let e of t)i.push(new BlogAuthorEntity(e));return i}buildElements(t=""){return(new DOMParser).parseFromString(t,"text/html").body}}class BlogsLabelEntity{constructor(t){this.label=t,this.label_link="/search/label/"+this.label,this.embeds=["label","label_link"]}}class BlogAuthorEntity{constructor(t){this.email=t.email.$t,this.image=t.gd$image,this.name=t.name.$t,this.uri=t.uri.$t,this.embeds=["email","image","name","uri"]}}
class BlogSearchInfo{constructor(t=window.location){this.host=t.host,this.hostname=t.hostname,this.origin=t.origin,this.pathname=t.pathname,this.label=void 0,this.buildLabel()}buildLabel(t=window.location.pathname){let e=t.split("/");"search"==e[1]&&"label"==e[2]&&(this.label=e[3])}}class BlogSearchApi{constructor(t){this.url="",this.path="",this.target="/feeds/posts/default",this.build(t)}async call(t=this.url){return await fetch(t,{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"})}build(t,e="?"){if(t instanceof BlogSearchInfo==0)throw Error("Blog info should be instance of BlogSearchInfo");null!=t.label&&(this.path="/-/"+t.label),this.url=t.origin+this.target+this.path+e}}
class Queries{constructor(e={}){this.init(e.queries),this.initRules(e.rules)}init(e={}){this.queries={...e}}initRules(e={}){this.rules={...e}}build(e={}){for(let i in e)this.setQueries(i,e[i])}buildByUrl(e=window.location.search){const i=new URLSearchParams(window.location.search);for(let e in this.queries)null!=i.get(e)&&this.setQueries(e,i.get(e))}fillApi(e="?"){for(let i in this.queries){let t=i;if(this.isFillApi(i)&&this.fillValidation(i,this.queries[i])&&(null!=this.isConverted(i)&&(t=this.isConverted(i)),1!=e.length&&(e+="&"),Array.isArray(this.queries[i])||(e+=t+"="+this.middleware(i,this.queries[i])),Array.isArray(this.queries[i])))for(let s of this.queries[i])1!=e.length&&(e+="&"),e+=t+"="+this.middleware(i,s)}return e}isFillApi(e){return!(null!=this.rules[e]&&!this.rules[e].fillApi)}fill(e="?"){for(let i in this.queries){let t=i;if(this.isFill(i)&&this.fillValidation(i,this.queries[i])&&(null!=this.isConverted(i)&&(t=this.isConverted(i)),1!=e.length&&(e+="&"),Array.isArray(this.queries[i])||(e+=t+"="+this.middleware(i,this.queries[i])),Array.isArray(this.queries[i])))for(let s of this.queries[i])1!=e.length&&(e+="&"),e+=t+"="+this.middleware(i,s)}return e}isFill(e){return!(null!=this.rules[e]&&!this.rules[e].fill)}isConverted(e){if(null!=this.rules[e]&&null!=this.rules[e].converted)return this.rules[e].converted}getQueries(e){this.queries[e]}setQueries(e,i){this.validation(e,i)&&(this.queries[e]=i)}fillValidation(e,i){return!0}validation(e,i){return!0}middleware(e,i){return i}}class BlogPagination extends Queries{init(e={}){this.queries={current_page:1,start_index:1,max_results:10,total_results:-1,...e}}initRules(e={}){this.rules={total_results:{fill:!1,fillApi:!1},total_page:{fill:!1,fillApi:!1},current_page:{fill:!0,fillApi:!1},start_index:{converted:"start-index",fill:!1,fillApi:!0},max_results:{converted:"max-results",fill:!1,fillApi:!0},...e}}setQueries(e,i){"current_page"==e?this.queries[e]=parseInt(i):this.validation(e,i)&&(this.queries[e]=i)}middleware(e,i){return"start_index"==e&&(i=parseInt(this.queries.start_index)+(parseInt(this.queries.current_page)-1)*parseInt(this.queries.max_results)),i}buildByFeed(e={}){if(null==e.feed)throw Error("response feeds property shouldn't empty");let i=e.feed,t=parseInt(i.openSearch$totalResults.$t),s=(parseInt(i.openSearch$startIndex.$t),parseInt(i.openSearch$itemsPerPage.$t));this.setQueries("total_page",Math.ceil(t/s)),this.setQueries("total_results",t)}}class BlogSearchQueries extends Queries{init(e={}){this.queries={q:"",alt:"json",...e}}initRules(e={}){this.rules={q:{fill:!0,fillApi:!0,converted:"q"},alt:{fill:!1,fillApi:!0},...e}}fillValidation(e,i){return"q"!=e||""!=i}}
class BlogSearch{constructor(i={}){this.isPaginate=1==i.isPaginate,this.BlogSearchInfo=new BlogSearchInfo(i.location),this.BlogSearchApi=new BlogSearchApi(this.BlogSearchInfo),this.BlogSearchQueries=new BlogSearchQueries(i.search_settings),this.BlogPosts=[],this.BlogPagination=new BlogPagination(i.pagination_settings),this.posts_container=i.posts_container?i.posts_container:document.getElementById("blog-posts"),this.pagination_container=i.pagination_container?i.pagination_container:document.getElementById("blog-pager"),this.BlogSearchQueries.buildByUrl(),this.BlogPagination.buildByUrl()}async run(){if(this.BlogSearchApi.build(this.BlogSearchInfo,this.buildApiQueries()),!this.isPaginate){let i=PaginationLazyLoader.build();null!=this.pagination_container.firstChild&&this.pagination_container.removeChild(this.pagination_container.firstChild),this.pagination_container.appendChild(i)}try{let i=await this.BlogSearchApi.call(),t=await i.json();this.resetEntity(),this.buildPostEntity(t),this.buildPaginationEntity(t),this.printPostsEntity(),this.printPaginationEntity()}catch(i){if(console.error(i),this.isPaginate){let i=ReloadPosts.build();null!=this.posts_container.firstChild&&this.posts_container.removeChild(this.posts_container.firstChild),this.posts_container.appendChild(i)}else{let i=PaginationReload.build();null!=this.pagination_container.firstChild&&this.pagination_container.removeChild(this.pagination_container.firstChild),i.addEventListener("click",(()=>{this.run()})),this.pagination_container.appendChild(i)}}}buildApiQueries(i="?"){return i=this.BlogSearchQueries.fillApi(i),i=this.BlogPagination.fillApi(i)}buildPostEntity(i){if(null!=i.feed.entry){for(let t of i.feed.entry)this.BlogPosts.push(new BlogPostEntity(t));console.log("pass")}}buildPaginationEntity(i){this.BlogPagination.buildByFeed(i),this.isPaginate||this.BlogPagination.queries.current_page++}buildPaginationQueries(i="?",t="#"){return"?"==(i=this.BlogSearchQueries.fill(i))?i+"current_page="+t:i+"&current_page="+t}printPostsEntity(){if(this.isPaginate&&(this.posts_container.innerHTML=""),this.BlogPosts.length<=0){let i=EmptyPosts.build();this.posts_container.appendChild(i)}else for(let i of this.BlogPosts){let t=PostBuilder.buildTemplate(i);if(i.labels.length>=1){let n=PostLabelBuilder.buildTemplate(i.labels[0]);t=PostBuilder.addSlot(t,n,"[[post-label]]")}let n=PostBuilder.buildElement(t);this.posts_container.appendChild(n)}}printPaginationEntity(){this.isPaginate&&(this.pagination_container.innerHTML="");let i=parseInt(this.BlogPagination.queries.current_page);if(this.isPaginate){if(i<=this.BlogPagination.queries.total_page){for(let t=Math.max(i-5,1);t<i;t++){let i=this.buildPaginationElement(String(t),this.buildPaginationQueries("?",t));this.pagination_container.appendChild(i)}let t=this.buildPaginationElement(String(i),"#");this.pagination_container.appendChild(t);for(let t=i+1;t<=this.BlogPagination.queries.total_page&&t<i+5;t++){let i=this.buildPaginationElement(String(t),this.buildPaginationQueries("?",t));this.pagination_container.appendChild(i)}}}else{let i=this.buildPaginationElement("","javascript:;");null!=this.pagination_container.firstChild&&this.pagination_container.removeChild(this.pagination_container.firstChild),this.pagination_container.appendChild(i)}}buildPaginationElement(i,t){let n=new BlogPaginationEntity({title:i,link:t});if(this.isPaginate)return PaginationLink.build(n);if(this.BlogPagination.queries.current_page>this.BlogPagination.queries.total_page)return PaginationMax.build(n);{let i=PaginationLazyButton.build(n);return i.addEventListener("click",(i=>{this.run()})),i}}resetEntity(){this.BlogPosts=[]}}let Main=new BlogSearch;Main.run();